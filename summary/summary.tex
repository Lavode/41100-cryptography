\documentclass[a4paper]{scrreprt}

% Uncomment to optimize for double-sided printing.
% \KOMAoptions{twoside}

% Set binding correction manually, if known.
% \KOMAoptions{BCOR=2cm}
% Localization options
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

% Quotations
\usepackage{dirtytalk}

% Enhanced verbatim sections. We're mainly interested in
% \verbatiminput though.
\usepackage{verbatim}

% Automatically remove leading whitespace in lstlisting
\usepackage{lstautogobble}

% PDF-compatible landscape mode.
% Makes PDF viewers show the page rotated by 90Â°.
\usepackage{pdflscape}

% Advanced tables
\usepackage{tabu}
\usepackage{longtable}

% Fancy tablerules
\usepackage{booktabs}

% Graphics
\usepackage{graphicx}

% Current time
\usepackage[useregional=numeric]{datetime2}

% Float barriers.
% Automatically add a FloatBarrier to each \section
\usepackage[section]{placeins}

% Custom header and footer
\usepackage{fancyhdr}

\usepackage{geometry}
\usepackage{layout}

% Math tools
\usepackage{mathtools}
% Math symbols
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{amsthm}

\DeclarePairedDelimiter\abs{\lvert}{\rvert}

% Indistinguishable operator (three stacked tildes)
\newcommand*{\diffeo}{% 
  \mathrel{\vcenter{\offinterlineskip
  \hbox{$\sim$}\vskip-.35ex\hbox{$\sim$}\vskip-.35ex\hbox{$\sim$}}}}

\pagestyle{plain}
% \fancyhf{}
% \lhead{}
% \lfoot{}
% \rfoot{}
% 
% Source code & highlighting
\usepackage{listings}

% Coloured boxes!
\usepackage[most]{tcolorbox}
\newtcolorbox{library}[2][]{
	enhanced,
	sharp corners,
	coltitle=black, % title colour
	colbacktitle=black!10!white, % title bg colour
	halign title=center, % title align
	toptitle=1mm, % Top/bottom additional spacing for title
	bottomtitle=1mm,
	fonttitle=\ttfamily,
	colback=white, % body bg colour
	fontupper=\ttfamily,
	title=#2,#1
}

\newtcolorbox{boxcomment}[2][]{
	enhanced,
	colframe=white, % frame colour
	colbacktitle=white, % title bg colour
	halign=center, % body align
	colback=white, % body bg colour
	fonttitle=\ttfamily,
	fontupper=\ttfamily,
	title=#2,#1
}

% SI units
\usepackage[binary-units=true]{siunitx}
\DeclareSIUnit\cycles{cycles}

% Convenience commands
\newcommand{\mailsubject}{41100 - Cryptography - Summary}
\newcommand{\maillink}[1]{\href{mailto:#1?subject=\mailsubject}
                               {#1}}

% Should use this command wherever the print date is mentioned.
\newcommand{\printdate}{\today}

\subject{41100 - Cryptography}
\title{Summary}

\author{Michael Senn \maillink{michael.senn@students.unibe.ch} - 16-126-880}

\date{\printdate}

% Needs to be the last command in the preamble, for one reason or
% another. 
\usepackage{hyperref}


\begin{document}
\maketitle


\chapter{Introduction}

\section{Goals of cryptography}

\begin{description}
	\item[Confidentiality] Ensure only authorized parties are able to read
		information. Encryption.
	\item[Integrity] Ensure information is not modified en-route.
		Signatures.
	\item[Availability] Ensure information reachable by authorized parties,
		not very relevant in modern contexts (not a cryptography
		topic).
\end{description}

\section{Generic model for a cryptosystem}

Alice wants to send message to Bob. Given a system $\Sigma$:

\begin{library}{$\Sigma$}
	\begin{lstlisting}[mathescape=true,autogobble=true]
		KeyGen() -> k
		Enc(k, m) -> c
		Dec(k, c) -> m'
	\end{lstlisting}
\end{library}

Assuming key exchange happens separately and securely, the goal is to achieve:
\begin{description}
	\item[Completness] Bob obtains $m' = m$
	\item[Security] Eve obtains `no useful' information about $m$
\end{description}

Which should hold for any sensible (excluding arbitrarily high computing power)
adversary Eve.

Modern-day security arguments are used which are not from the base up, but are
based on assumptions such as $N \neq NP$.

\section{Kerkhoff's principle}

The security of a crypto system should not rely on the secrecy of the system's
algorithms. This allows studying, reviewing \& reusing a system in public
without compromising its security.

\section{One-time pad}

Perfectly secure, and just as inconvenient.

\begin{library}{Vernam cipher $\Sigma$}
	\begin{lstlisting}[mathescape=true,autogobble=true]
		KeyGen():
		  k <- $\Sigma^l$
		  return k

		Enc(k, m):
		  return $k \oplus m$

		Dec(k, c):
		  return $k \oplus c$
	\end{lstlisting}
\end{library}

\begin{itemize}
	\item Uniform radom ciphertext
	\item Plaintext perfectly hidden
	\item Ciphertext can be decrypted with any key, only one of which
		yields original plaintext
\end{itemize}

\chapter{Provable security}

Information-theoretically secure (eg OTP): No matter computational power of
adversary, no information is gained. Computationally secure: All information is
there, but information lacks time to derive it.

\section{Formalization of encryption}

\subsection{Correctness}

A cryptosystem $\Sigma$ is secure if:
\[
	P[Dec(k, Enc(k, m)) = m] = 1 \forall k \in K, m \in M
\]

\subsection{Exchangable}

Two libraries $L_1, L_2$ are exchangable (notation $L_1 \equiv L_2$) if for all distinguishing algorithms $A$:
\[
	P[A \diamond L_1 = 1] = P[A \diamond L_2 = 1]
\]

\subsection{Uniform ciphertext}

An encryption scheme $\Sigma$ has uniform ciphertexts if the following two
libraries are indistinguishable.

\begin{tcbraster}[raster columns=2,raster equal height,nobeforeafter,raster column skip=2cm]
	\begin{library}{$L_{\text{OTS\$-Real}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			CTXT(m):
			  k <- KeyGen()
			  c <- Enc(k, m)
			  return c
		\end{lstlisting}
	\end{library}
	\begin{library}{$L_{\text{OTS\$-Rand}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			CTXT(m):
			  c <- C
			  return c
		\end{lstlisting}
	\end{library}
\end{tcbraster}


\subsection{One-time secrecy}

An encryption scheme $\Sigma$ has one-time secrecy if the following two
libraries are indistinguishable.

\begin{tcbraster}[raster columns=2,raster equal height,nobeforeafter,raster column skip=2cm]
	\begin{library}{$L_{\text{OTS-Left}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			Eavesdrop($m_l, m_r$):
			  k <- KeyGen()
			  c <- Enc(k, m_l)
			  return c
		\end{lstlisting}
	\end{library}
	\begin{library}{$L_{\text{OTS-Right}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			Eavesdrop($m_l, m_r$):
			  k <- KeyGen()
			  c <- Enc(k, m_r)
			  return c
		\end{lstlisting}
	\end{library}
\end{tcbraster}

\subsection{Chaining lemma}

If $L_1 \equiv L_2$, then $A \diamond L_1 \equiv A \diamond L_2 \forall A$

\subsection{Computational security}

Secure against a probabilistic polynomial time attacker in all but negligibly
many cases.

\subsubsection{Negligible probabilities}

A function $f(\lambda)$ is negligible if $\lim f(\lambda) p(\lambda) = 0
\forall p\ \text{polynomial}$.

\subsubsection{Indistinguishability}

Two libraries $L_1, L_2$ are indistinguishable $L_1 \approx L_2$ if $P[A
\diamond L_1 \rightarrow 1] \approx P[A \diamond L_2 \rightarrow 1]$ for every
probabilistic polynomial-time distinguisher $A$

\chapter{Pseudorandom generator PRG}

A PRG is a deterministic function which:
\begin{itemize}
	\item Stretches a short truly random seed to a large sequence of pseudorando bits
	\item Directly gives a stream cipher
	\item Is the most basic tool of cryptography
\end{itemize}

\section{PRG}

A deterministic function $G: \{0, 1\}^\lambda \rightarrow \{0, 1\}^{\lambda +
l}$ which satisfies $L_{\text{PRG-Real}} \equiv L_{\text{PRG-Rand}}$ where:

\begin{tcbraster}[raster columns=2,raster equal height,nobeforeafter,raster column skip=2cm]
	\begin{library}{$L_{\text{PRG-Real}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			Query():
			  $s \leftarrow \{0, 1\}^\lambda$
			  return G(s)
		\end{lstlisting}
	\end{library}
	\begin{library}{$L_{\text{PRG-Rand}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			Query():
			  $r \leftarrow \{0, 1\}^{\lambda + l}$
			  return r
		\end{lstlisting}
	\end{library}
\end{tcbraster}

Note that $|domain(G)| = 2^\lambda \geq |image(G)|$, with equality iff $G$ is injective.

\subsection{Stream cipher using PRG $G$}

\begin{library}{$S$}
	\begin{lstlisting}[mathescape=true,autogobble=true]
		$K = \{0, 1\}^\lambda$
		$M = \{0, 1\}^{\lambda + l}$
		$C = \{0, 1\}^{\lambda + l}$

		KeyGen():
		  $k \leftarrow K$
		  return k

		Enc(k, m):
		  return $G(k) \oplus m$

		Dec(k, c):
		  return $G(k) \oplus c$
	\end{lstlisting}
\end{library}

If $G$ is a secure PRG, then S possesses computational one-time secrecy.

% TODO 2019-10-11 and 2019-10-30

\chapter{Pseudorandom functions}

Given a key in $\{0, 1\}^\lambda$ it provides, for every input in $\{0,
1\}^{in}$, an output in $\{0, 1\}^{out}$, indistinguishable from uniform random
outputs on that same set.

A PRF $F: \{0, 1\}^\lambda \times \{0, 1\}^{in} \rightarrow \{0, 1\}^{out}$ is
a secure PRF if the following two libraries are indistinguishable.

\begin{tcbraster}[raster columns=2,raster equal height,nobeforeafter,raster column skip=2cm]
	\begin{library}{$L^F_{\text{PRF\$-Real}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			$k \rightarrow \{0, 1\}^\lambda$

			LOOKUP($x \in \{0, 1\}^{in}$):
			  return F(k, x)
		\end{lstlisting}
	\end{library}
	\begin{library}{$L^F_{\text{PRF\$-Rand}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			T := {}

			LOOKUP($x \in \{0, 1\}^{in}$):
			  if x not in T:
			    T[x] $\rightarrow \{0, 1\}^{out}$
			  return T[x]
		\end{lstlisting}
	\end{library}
\end{tcbraster}

\chapter{Block ciphers}

\section{Constructing PRG from PRF}

Given a PRF $F: \{0, 1\}^\lambda \times \{0, 1\}^\lambda \rightarrow \{0,
1\}^\lambda$, we can construct a secure PRG $G: \{0, 1\}^\lambda \rightarrow
\{0, 1\}^{k \cdot \lambda}$ as:

\begin{lstlisting}[mathescape=true,autogobble=true]
	G($s \in \{0, 1\}^\lambda$):
	  for i = 1 to k do:
	    $x_j := F(s, j)$
	  return $x_1 || .. || x_k$
\end{lstlisting}

\section{Pseudo-random permutations PRP}

$F: \{0, 1\}^\lambda \times \{0, 1\}^b \rightarrow \{0, 1\}^b$ is a
pseudorandom permutation on $b$-bit strings if:
\begin{itemize}
	\item There exists a PRP $F^{-1}$ such that $F^{-1}(k, F(k, x)) = x \forall x$
	\item The following two libraries are indistinguishable
\end{itemize}

\begin{tcbraster}[raster columns=2,raster equal height,nobeforeafter,raster column skip=2cm]
	\begin{library}{$L^F_{\text{PRP\$-Real}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			$k \rightarrow \{0, 1\}^\lambda$

			LOOKUP(x)
			  return F(k, x)
		\end{lstlisting}
	\end{library}
	\begin{library}{$L^F_{\text{PRP\$-Rand}}$}
		\begin{lstlisting}[mathescape=true,autogobble=true]
			T := {}
			R := {}

			LOOKUP(x)
			  if x not in T:
			    T[x] = $\{0, 1\}^b \setminus R$
			    $R := R \cup \{T[x]\}$
			  return T[x]
		\end{lstlisting}
	\end{library}
\end{tcbraster}

Indistinguishable as $|R| / 2^\lambda$ negligible.

Further: If F is secure PRP, then if is also secure PRF.

\subsection{Constructiing secure PRP from PRF}

Given a PRF $F: \{0, 1\}^\lambda \times \{0, 1\}^\lambda \rightarrow \{0,
1\}^\lambda$, construct a PRP $P$ as follows:

\begin{lstlisting}[mathescape=true,autogobble=true]
	P(k, x || y):
	  return $y || (F(k, y) \oplus x)$

	P^{-1}(k, y || x'):
	  return $(x \oplus F(k, y)) || y$
\end{lstlisting}

\end{document}

